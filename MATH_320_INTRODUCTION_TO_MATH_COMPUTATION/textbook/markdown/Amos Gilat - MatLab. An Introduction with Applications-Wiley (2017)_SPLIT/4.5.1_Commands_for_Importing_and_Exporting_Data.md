114

Chapter 4: Using Script Files and Managing Data

4.5 IMPORTING AND EXPORTING DATA

MATLAB is often used for analyzing data that was recorded in experiments or
generated by other computer programs. This can be done by first importing the
data into MATLAB. Similarly, data that is produced by MATLAB sometimes
needs to be transferred to other computer applications. There are various types
of  data  (numerical,  text,  audio,  graphics,  and  images).  This  section  describes
only how to import and export numerical data, which is probably the most com-
mon type of data that needs to be transferred by new users of MATLAB. For
other types of data transfer, look in the Help Window under File I/O.

Importing  data  can  be  done  either  by  using  commands  or  by  using  the
Import  Wizard.  Commands  are  useful  when  the  format  of  the  data  being
imported  is  known.  MATLAB  has  several  commands  that  can  be  used  for
importing various types of data. Importing commands can also be included in a
script file such that the data is imported when the script is executed. The Import
Wizard is useful when the format of the data (or the command that is applicable
for importing the data) is not known. The Import Wizard determines the format
of the data and automatically imports it.

4.5.1 Commands for Importing and Exporting Data

This  section  describes—in  detail—how  to  transfer  data  into  and  out  of  Excel
spreadsheets. Microsoft Excel is commonly used for storing data, and Excel is
compatible with many data recording devices and computer applications. Many
people  are  also  capable  of  importing  and  exporting  various  data  formats  into
and from Excel. MATLAB also has commands for transferring data directly to
and from formats such as csv and ASCII, as well as to the spreadsheet program
Lotus 123. Details of these and many other commands can be found in the Help
Window under File I/O

Importing and exporting data into and from Excel:

Importing  data  from  Excel  is  done  with  the  xlsread  command.  When  the
command is executed, the data from the spreadsheet is assigned as an array to a
variable. The simplest form of the xlsread command is:

variable_name = xlsread(‘filename’)

• ‘filename’ (typed as a string) is the name of the Excel file. The directory of
the Excel file must be either the current directory or listed in the search path.

•

If the Excel file has more than one sheet, the data will be imported from the first
sheet.

4.5 Importing and Exporting Data

115

When an Excel file has several sheets, the xlsread command can be used to
import data from a specified sheet. The form of the command is then:

variable_name = xlsread(‘filename’,‘sheet_name’)

• The name of the sheet is typed as a string.

Another option is to import only a portion of the data that is in the spreadsheet.
This is done by typing an additional argument in the command:

variable_name = xlsread(‘filename’,‘sheet_name’,‘range’)

• The  ‘range’  (typed  as  a  string)  is  a  rectangular  region  of  the  spreadsheet
defined by the addresses (in Excel notation) of the cells at opposite corners of
the region. For example, ‘C2:E5’ is a
 region of rows 2, 3, 4, and 5 and
columns C, D, and E.

Exporting  data  from  MATLAB  to  an  Excel  spreadsheet  is  done  by  using  the
xlswrite command. The simplest form of the command is:

xlswrite(‘filename’,variable_name)

• ‘filename’ (typed as a string) is the name of the Excel file to which the data
is exported. The file must be in the current directory. If the file does not exist, a
new Excel file with the specified name will be created.

• variable_name is the name of the variable in MATLAB with the assigned

data that is being exported.

• The  arguments  ‘sheet_name’  and  ‘range’  can  be  added  to  the  xls-
write command to export to a specified sheet and to a specified range of cells,
respectively.

As  an  example,  the  data  from  the  Excel  spreadsheet  shown  in  Figure  4-7  is
imported into MATLAB by using the xlsread command.

Figure 4-7: Excel spreadsheet with data.


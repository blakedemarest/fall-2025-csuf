11.9 Examples of MATLAB Applications

375

(b) Use MATLAB to solve the equation derived in part (a).
(c) For the angle determined in part (b), use the ezplot command to make a

plot of the projectile’s trajectory.

Solution

(a)  The motion of the projectile can be analyzed by considering the horizontal
and vertical components. The initial velocity
 can be resolved into horizontal
and vertical components:
=

    and

v0

=

v0x

v0 cos

v0 sin

v0y

In the horizontal direction the velocity is constant, and the position of the pro-
jectile as a function of time is given by:

x

=

v0xt

Substituting
2600
to reach the target and

=

x

 m for the horizontal distance that the projectile travels
210 cos

, and solving for t gives:

 for

v0x

In the vertical direction the position of the projectile is given by:

t

=

2600
--------------------------
210 cos

Substituting
y
v0x g
,
9.81

=

 m for the vertical coordinate of the target,

=
350
, and t gives:

210 sin

 for

or:

The solution of this equation gives the angle
fired.

 at which the projectile has to be

(b)  A solution of the equation derived in part (a) obtained by using the solve
command (in the Command Window) is:

>> syms th

Angle = solve('2600*sqrt(1 - cos(th)^2)/cos(th) -
0.5*9.81*(2600/(210*cos(th)))^2 = 350')

Angle =
    1.245354497237416168313813580656
  0.45925280703207121277786452037279
 -0.45925280703207121277786452037279
   -1.245354497237416168313813580656

MATLAB displays four
solutions. The two posi-
tive ones are relevant to
the problem.

376

Chapter 11: Symbolic Math

>> Angle1 = Angle(1)*180/pi

Converting  the  solution  in  the  first  ele-
ment of Angle from radians to degrees.

Angle1 =
224.16380950273491029648644451808/pi

MATLAB displays the answer as
a symbolic object in terms of  .

>> Angle1=double(Angle1)

Angle1 =
   71.3536

Use the double command to obtain
numerical values for Angle1.

>> Angle2=Angle(2)*180/pi

Converting the solution in the second ele-
ment of Angle from radians to degrees.

Angle2 =
82.665505265772818300015613667102/pi

MATLAB displays the answer as
a symbolic object in terms of  .

>> Angle2=double(Angle2)

Angle2 =
   26.3132

Use the double command to obtain
numerical values for Angle2.

(c)  The solution from part (b) shows that there are two possible angles and thus
two trajectories. In order to make a plot of a trajectory, the x and y coordinates
of the projectile are written in terms of t (parametric form):

x

=

v0 cos

t

  and

The domain for t is

t

0=

 to

t

=

2600
--------------------------
210 cos

.

These equations can be used in the ezplot command to make the plots shown
in the following program written in a script file.

xmax=2600; v0=210; g=9.81;

theta1=1.24535; theta2=.45925;

t1=xmax/(v0*cos(theta1));

t2=xmax/(v0*cos(theta2));

syms t

X1=v0*cos(theta1)*t;

X2=v0*cos(theta2)*t;

Y1=v0*sin(theta1)*t-0.5*g*t^2;

Y2=v0*sin(theta2)*t-0.5*g*t^2;

ezplot(X1,Y1,[0,t1])

hold on

Assign  the  two  solutions  from
part (b) to theta1 and theta2.

Plot one trajectory.

ezplot(X2,Y2,[0,t2])

Plot a second trajectory.

hold off

11.9 Examples of MATLAB Applications

377

When  this  program  is  executed,  the  following  plot  is  generated  in  the  Figure
Window:

x = (6623137634930013 t)/35184372088832, y = (3275240998958541 t)/35184372088832 - (981 t2)/200

2000

1800

1600

1400

1200

y

1000

800

600

400

200

0

0

500

1000

1500

2000

2500

x

Sample Problem 11-3: Bending resistance of a beam

The  bending  resistance  of  a  rectangular  beam  of
width  b  and  height  h  is  proportional  to  the  beam’s

moment of inertia I, defined by

I

=

1
------bh3
12

. A rect-

angular beam is cut out of a cylindrical log of radius
R. Determine b and h (as a function of R) such that
the beam will have maximum I.

Solution

The problem is solved by following these steps:
1. Write an equation that relates R, h, and b.
2. Derive an expression for I in terms of h.
3. Take the derivative of I with respect to h.
4. Set the derivative equal to zero and solve for h.
5. Determine the corresponding b.

The first step is carried out by looking at the triangle
in the figure. The relationship between R, h, and b is given by the Pythagorean

theorem as

2

+

b
---
2

2

h
---
2

R2=

. Solving this equation for b gives

.

The rest of the steps are done using MATLAB:

>> syms b h R

>> b=sqrt(4*R^2-h^2);

Create a symbolic expression for b.

>> I=b*h^3/12

Step 2: Create a symbolic expression for I.

I =
(h^3*(4*R^2-h^2)^(1/2))/12

MATLAB substitutes b in I.

378

Chapter 11: Symbolic Math

>> ID=diff(I,h)

ID =
(h^2*(4*R^2-h^2)^(1/2))/4-h^4/(12*(4*R^2-h^2)^(1/2))

Step 3: Use the diff(R)command
to differentiate I with respect to h.

>> hs=solve(ID,h)

hs =
          0
  3^(1/2)*R
 -3^(1/2)*R

The derivative of I is displayed.

Step 4: Use the solve command to solve the
equation ID = 0 for h. Assign the answer to hs.

MATLAB displays three solutions. The positive
 is relevant to the problem.
non zero solution

3R

>> bs=subs(b,hs(2))

Step 5: Use the subs command to determine b by
substituting the solution for h in the expression for

bs =
(R^2)^(1/2)

The answer for b is displayed. (The answer is R,

but MATLAB displays

.)

Sample Problem 11-4: Fuel level in a tank

The  horizontal  cylindrical  tank  shown  is
used to store fuel. The tank has a diameter
of 6 m and is 8 m long. The amount of fuel
in the tank can be estimated by looking at
the level of the fuel through a narrow verti-
cal glass window at the front of the tank. A
scale  that  is  marked  next  to  the  window
shows  the  levels  of  the  fuel  corresponding
to 40, 60, 80, 120, and 160 thousand liters.
Determine the vertical positions (measured
from the ground) of the lines of the scale.

Solution

The relationship between the level of the fuel and its volume can be written in
the form of a definite integral. Once the integration is carried out, an equation is
obtained for the volume in terms of the fuel’s height. The height corresponding
to a specific volume can then be determined from solving the equation for the
height.

11.9 Examples of MATLAB Applications

379

The volume of the fuel V can be determined
by multiplying the area of the cross section
of the fuel A (the shaded area) by the length
of  the  tank  L.  The  cross-sectional  area  can
be calculated by integration.
h
L w yd
0

AL

V

=

=

The  width  w  of  the  top  surface  of  the  fuel
can be written as a function of  y. From the
triangle  in  the  figure  on  the  right,  the  vari-
ables y, w, and R are related by:

Solving this equation for w gives:

The volume of the fuel at height h can now be calculated by substituting w in the
integral  in  the  equation  for  the  volume  and  carrying  out  the  integration.  The
result is an equation that gives the volume V as a function of h. The value of h
for a given V is obtained by solving the equation for h. In the present problem
values of h have to be determined for volumes of 40, 60, 80, 120, and 160 thou-
sand  liters.  The  solution  is  given  in  the  following  MATLAB  program  (script
file):

R=3; L=8;

syms w y h

w=2*sqrt(R^2-(R-y)^2)

S = L*w

V = int(S,y,0,h)

Create a symbolic expression for w.
Create the expression that will be integrated.

Use the int command to integrate S from
0 to h. The result gives V as a function of h.

Vscale=[40:40:200]

Create a vector with the values of V in the scale.

for i=1:5

    Veq=V-Vscale(i);

Each pass in the loop solves h for one value of V.
Create the equation for h that has to be solved.

    h_ans(i)=solve(Veq);

Use the solve command to solve for h.
h_ans is a vector (symbolic with numbers) with the values of
h that correspond to the values of V in the vector Vscale.

end

h_scale=double(h_ans)

Use the double command to obtain numeri-
cal values for the elements of vector h_ans.

When the script file is executed, the outcomes from commands that don’t have a

380

Chapter 11: Symbolic Math

semicolon at the end are displayed. The display in the Command Window is:

>> w =
2*(9-(y-3)^2)^(1/2)

S =
16*(9-(y-3)^2)^(1/2)

The symbolic expression for w is displayed.

S is the expression that will be integrated.

V =
36*pi+72*asin(h/3-1)+8*(9-(h-3)^2)^(1/2)*(h-3)

Vscale =
  40  80  120  160  200

The result from the integration; V as a function of h.

The values of V in the scale are displayed.

h_scale =
  1.3972  2.3042  3.1439  3.9957  4.9608

The positions of the lines in the scale are displayed.

Units: The unit for length in the solution is meters, which correspond to m3 for
the volume (1 m3 = 1,000 L).

Sample Problem 11-5: Amount of medication in the body

The amount M of medication present in the body depends on the rate at which
the medication is consumed by the body and on the rate at which the medication
enters the body, where the rate at which the medication is consumed is propor-
tional to the amount present in the body. A differential equation for M is

where k is the proportionality constant and p is the rate at which the medication
is injected into the body.
(a) Determine k if the half-life of the medication is 3 hours.
(b) A patient is admitted to a hospital and the medication is given at a rate of 50
mg per hour. (Initially there is no medication in the patient’s body.) Derive
an expression for M as a function of time.

(c) Plot M as a function of time for the first 24 hours.

Solution

(a)  The proportionality constant can be determined from considering the case
in  which  the  medication  is  consumed  by  the  body  and  no  new  medication  is
given. In this case the differential equation is:

The equation can be solved with the initial condition

M M0
=

 at

t

0=

:

>> syms M M0 k t

11.9 Examples of MATLAB Applications

381

>> Mt=dsolve('DM=-k*M','M(0)=M0')

Use the dsolve command

Mt =
M0/exp(k*t)

to solve

.

The solution gives M as a function of time:

M t

=

M0
--------
ekt

A half-life of 3 hours means that at

t

3=

 hours

M t

=

1
---M
2

0

. Substituting this

information in the solution gives

0.5

=

1
e3k-------

, and the constant k is determined

from solving this equation:

ks=solve('0.5=1/exp(k*3)')

ks =
.23104906018664843647241070715273

Use the solve command
to solve

.

(b)  For this part the differential equation for M is:

The constant k is known from part (a), and
 mg/h is given. The initial
condition is that in the beginning there is no medication in the patient’s body, or
M 0=

. The solution of this equation with MATLAB is:

50=

0=

 at

p

t

>> syms p

>> Mtb=dsolve('DM=-k*M+p','M(0)=0')

Use the dsolve command

Mtb =
(p-p/exp(k*t))/k)

(c)  A plot of Mtb as a function of time for
ezplot command:

>> pgiven=50;

>> Mtt=subs(Mtb,{p,k},{pgiven,ks})

Mtt =
216.404-216.404/exp(0.231049*t)

>> ezplot(Mtt,[0,24])

to solve

.

 can be done by using the

Substitute numerical
values for p and k.

In  the  actual  display  of  the  last  expression  that  was  generated  by  MATLAB
(Mtt = . . .) the numbers have many more decimal digits than shown above. The
numbers were shortened so that they will fit on the page.
The plot that is generated is:


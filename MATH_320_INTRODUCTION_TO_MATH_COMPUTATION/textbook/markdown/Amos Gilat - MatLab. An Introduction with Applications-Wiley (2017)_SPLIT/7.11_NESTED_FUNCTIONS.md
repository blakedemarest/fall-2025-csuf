242

Chapter 7: User-Defined Functions and Function Files

>> Grades=[80 75 91 60 79 89 65 80 95 50 81];

>> [AveGrade StanDeviation] = stat(Grades)

AveGrade =
   76.8182

StanDeviation =
   13.6661

7.11 NESTED FUNCTIONS

A nested function is a user-defined function that is written inside another user-
defined function. The portion of the code that corresponds to the nested func-
tion starts with a function definition line and ends with an end statement. An
end statement must also be entered at the end of the function that contains the
nested function. (Normally, a user-defined function does not require a terminat-
ing end statement. However, an end statement is required if the function con-
tains one or more nested functions.) Nested functions can also contain nested
functions. Obviously, having many levels of nested functions can be confusing.
This section considers only two levels of nested functions.

One nested function:

The format of a user-defined function A (called the primary function) that con-
tains one nested function B is:

function y=A(a1,a2)
.......

function z=B(b1,b2)
.......
end
.......
end

• Note the end statements at the ends of functions B and A.

• The nested function B can access the workspace of the primary function A, and
the primary function A can access the workspace of the function B. This means
that a variable defined in the primary function A can be read and redefined in
nested function B and vice versa.

• Function A can call function B, and function B can call function A.

Two (or more) nested functions at the same level:

The format of a user-defined function A (called the primary function) that con-
tains two nested functions B and C at the same level is:

7.11 Nested Functions

243

function y=A(a1,a2)
.......

function z=B(b1,b2)
.......
end
.......

function w=C(c1,c2)
.......
end
.......
end

• The three functions can access the workspace of each other.

• The three functions can call each other.

As  an  example,  the  following  user-defined  function  (named  statNest),
with two nested functions at the same level, solves Sample Problem 7-4. Note
that the nested functions are using variables (n and me) that are defined in the
primary function.

function [me SD]=statNest(v)

The primary function.

n=length(v);

me=AVG(v);

    function av=AVG(x)

    av=sum(x)/n;

    end

Nested function.

    function Sdiv=StandDiv(x)

Nested function.

    xdif=x-me;

    xdif2=xdif.^2;

    Sdiv= sqrt(sum(xdif2)/(n-1));

    end

SD=StandDiv(v);

end

Using the user-defined function statNest in the Command Window for cal-
culating the average of the grade data gives:

>> Grades=[80 75 91 60 79 89 65 80 95 50 81];

>> [AveGrade StanDeviation] = statNest(Grades)

244

Chapter 7: User-Defined Functions and Function Files

AveGrade =
   76.8182

StanDeviation =
   13.6661

Two levels of nested functions:

Two  levels  of  nested  functions  are  created  when  nested  functions  are  written
inside  nested  functions.  The  following  shows  an  example  for  the  format  of  a
user-defined function with four nested functions in two levels.

function y=A(a1,a2)
.......

function z=B(b1,b2)
.......

function w=C(c1,c2)
.......
end

end
function u=D(d1,d2)
.......

function h=E(e1,e2)
.......
end

end
.......
end

(Primary function A.)

(B is nested function in A.)

(C is nested function in B.)

(D is nested function in A.)

(E is nested function in D.)

The following rules apply to nested functions:
• A nested function can be called from a level above it. (In the preceding example,

function A can call B or D, but not C or E.)

• A nested function can be called from a nested function at the same level within
the primary function. (In the preceding example, function B can call D, and D
can call B.)

• A nested function can be called from a nested function at any lower level.

• A variable defined in the primary function is recognized and can be redefined by

a function that is nested at any level within the primary function.

• A variable defined in a nested function is recognized and can be redefined by any

of the functions that contain the nested function.


160

Chapter 5: Two-Dimensional Plots

Figure 5-14:  Using the PLOTS Toolstrip.

As an example, two different figures, one with line plot and the other with
bar plot,  were created  using the two  vectors  yr and  sle.  The  two figures are
displayed in Figure 5-14 and the commands that created the plots are displayed
in the Command Window in Figure 5-13.
Additional notes:

• When selecting variables for the plot (in the
Workspace  Window),  the  first  to  be
selected  will  be  the  independent  variable
(horizontal axis) and the second will be the
dependent variable (vertical axis). After the
selection, the  variables can be switched by
clicking on the Switch icon.

•

If only one variable (vector) is selected for a figure, the values of the vector ele-
ments will be plotted versus the number of the element.

5.13 EXAMPLES OF MATLAB APPLICATIONS

Sample Problem 5-2: Piston-crank mechanism

The piston-rod-crank mechanism is used in many engineering applications. In
the mechanism shown in the following figure, the crank is rotating at a constant
speed of 500 rpm.

Calculate and plot the position, velocity, and acceleration of the piston for one

5.13 Examples of MATLAB Applications

161

revolution  of  the  crank.  Make  the  three  plots  on  the  same  page.  Set
when  t = 0.

0=

Solution

The crank is rotating with a constant angular velocity
set
that

 = 0° when t = 0, then at time t the angle

 at all times.

 is given by

. This means that if we
, and means

The distances d1 and h are given

by:

h

=

=

r sin

r cos

   and

d1
With h known, the distance d2 can be
calculated  using  the  Pythagorean
Theorem:

The position x of the piston is then given by:

The derivative of x with respect to time gives the velocity of the piston:

The second derivative of x with respect to time gives the acceleration of the pis-
ton:

In the equation above,

 was taken to be zero.

A  MATLAB  program  (script  file)  that  calculates  and  plots  the  position,
velocity, and acceleration of the piston for one revolution of the crank is shown
below.

THDrpm=500; r=0.12; c=0.25;

Define

, r, and c.

THD=THDrpm*2*pi/60;

tf=2*pi/THD;

t=linspace(0,tf,200);

TH=THD*t;

d2s=c^2-r^2*sin(TH).^2;

x=r*cos(TH)+sqrt(d2s);

Change the units of

 from rpm to rad/s.
Calculate the time for one revolution of the crank.
Create a vector for the time with 200 elements.
 for each t.
Calculate
Calculate d2 squared for each  .
Calculate x for each  .

xd=-r*THD*sin(TH)-(r^2*THD*sin(2*TH))./(2*sqrt(d2s));

162

Chapter 5: Two-Dimensional Plots

xdd=-r*THD^2*cos(TH)-(4*r^2*THD^2*cos(2*TH).*d2s+
(r^2*sin(2*TH)*THD).^2)./(4*d2s.^(3/2));

subplot(3,1,1)

plot(t,x)

grid

xlabel('Time (s)')

ylabel('Position (m)')

subplot(3,1,2)

plot(t,xd)

grid

xlabel('Time (s)')

ylabel('Velocity (m/s)')

subplot(3,1,3)

plot(t,xdd)

grid

xlabel('Time (s)')

Calculate

 and

 for each  .

Plot x vs. t.

Format the first plot.

 vs. t.
Format the second plot.

Plot

Plot

 vs. t.
Format the third plot.

ylabel('Acceleration (m/s^2)')

When  the  script  file  runs  it  generates  the  three  plots  on  the  same  page  as
shown in Figure 5-13. The figure nicely shows that the velocity of the piston is
zero at the end points of the travel range where the piston changes the direction
of the motion. The acceleration is maximum (directed to the left) when the pis-
ton is at the right end.

)

m

(
n
o
i
t
i
s
o
P

0.4

0.3

0.2

0.1

10

0

)
s
/
m

(

y
t
i
c
o
e
V

l

0

0.02

0.04

0.06
Time (s)

0.08

0.1

0.12

-10

0

500

0

-500

0

0.02

0.04

0.06
Time (s)

0.08

0.1

0.12

0.02

0.04

0.06
Time (s)

0.08

0.1

0.12

)

2

s
/
m

(
n
o

i
t

l

a
r
e
e
c
c
A

Figure 5-15: Position, velocity, and acceleration of the piston vs. time.

5.13 Examples of MATLAB Applications

163

Sample Problem 5-3: Electric Dipole

The electric field at a point due to a charge is a vector E
with magnitude E given by Coulomb’s law:

E

=

1
-----------
4
0

q
r2----

where

  is  the  permittivity

constant, q is the magnitude of the charge, and r is the
distance between the charge and the point. The direc-
tion of E is along the line that connects the charge with
the point. E points outward from q if q is positive, and
toward q if q is negative. An electric dipole is created when a positive charge and
a negative charge of equal magnitude are placed some distance apart. The elec-
tric field, E, at any point is obtained by superposition of the electric field of each
charge.
An

y

electric

dipole
with
C is created, as shown in
the  figure.  Determine  and  plot  the
magnitude  of  the  electric  field  along
the  x  axis
to
from
cm.

cm

x

+q

q

(  2 cm,   2 cm)

(2 cm,   2 cm)

Solution
The  electric field  E  at  any  point (x, 0)
along the x axis is obtained by adding
the electric field vectors due to each of
the charges.

E = E–+ E+

The  magnitude  of  the  electric  field  is
the length of the vector E.

The problem is solved by following these steps:

Step 1: Create a vector x for points along the x axis.

Step 2: Calculate the distance (and distance squared) from each charge to the

points on the x axis.

Step 3: Write unit vectors in the direction from each charge to the points on

the x axis.

164

Chapter 5: Two-Dimensional Plots

Step 4: Calculate  the  magnitude  of  the  vector  E–  and  E+  at  each  point  by

using Coulomb’s law.

Step 5: Create the vectors E– and  E+ by multiplying the unit vectors by the

magnitudes.

Step 6: Create the vector E by adding the vectors E– and E+.
Step 7: Calculate E, the magnitude (length) of E.

Step 8:

Plot E as a function of x.

A program in a script file that solves the problem is:

q=12e-9;
epsilon0=8.8541878e-12;

x=[-0.05:0.001:0.05]’;

rminusS=(0.02-x).^2+0.02^2;

rminus=sqrt(rminusS);

rplusS=(x+0.02).^2+0.02^2;
rplus=sqrt(rplusS);

EminusUV=[((0.02-x)./rminus), (-0.02./rminus)];

EplusUV=[((x+0.02)./rplus), (0.02./rplus)];

EminusMAG=(q/(4*pi*epsilon0))./rminusS;

EplusMAG=(q/(4*pi*epsilon0))./rplusS;

Create a column vector x.

Step 2. Each variable
is a column vector.

Steps 3 & 4. Each vari-
able is a two column
matrix. Each row is
the vector for the cor-
responding x.

Eminus=[EminusMAG.*EminusUV(:,1), EminusMAG.*EminusUV(:,2)];

Eplus=[EplusMAG.*EplusUV(:,1), EplusMAG.*EplusUV(:,2)];

E=Eminus+Eplus;

EMAG=sqrt(E(:,1).^2+E(:,2).^2);

plot(x,EMAG,'k','linewidth',1)

Step 6.

Step 7.

Step 5.

xlabel('Position along the x-axis (m)','FontSize',12)

ylabel('Magnitude of the electric field (N/C)','FontSize',12)

title('ELECTRIC FIELD DUE TO AN ELECTRIC DIPOLE','FontSize',12)

When this script file is executed in the Command Window, the following figure
is created in the Figure Window:


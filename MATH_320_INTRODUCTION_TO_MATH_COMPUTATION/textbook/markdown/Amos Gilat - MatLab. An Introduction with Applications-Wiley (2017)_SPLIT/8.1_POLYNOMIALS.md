Chapter 8
Polynomials,
Curve Fitting, and
Interpolation

Polynomials are mathematical expressions that are frequently used for problem
solving  and  modeling  in  science  and  engineering.  In  many  cases  an  equation
that is written in the process of solving a problem is a polynomial, and the solu-
tion of the problem is the zero of the polynomial. MATLAB has a wide selec-
tion of functions that are specifically designed for handling polynomials. How
to use polynomials in MATLAB is described in Section 8.1.

Curve  fitting  is  a  process  of  finding  a  function  that  can  be  used  to  model
data.  The  function  does  not  necessarily  pass  through  any  of  the  points,  but
models the data with the smallest possible error. There are no limitations to the
type of the equations that can be used for curve fitting. Often, however, polyno-
mial, exponential, and power functions are used. In MATLAB curve fitting can
be done by writing a program or by interactively analyzing data that is displayed
in  the  Figure  Window.  Section  8.2  describes  how  to  use  MATLAB  program-
ming  for  curve  fitting  with  polynomials  and  other  functions.  Section  8.4
describes the basic fitting interface that is used for interactive curve fitting and
interpolation.

Interpolation  is  the  process  of  estimating  values  between  data  points.  The
simplest  kind  of  interpolation  is  done  by  drawing  a  straight  line  between  the
points.  In  a  more  sophisticated  interpolation,  data  from  additional  points  is
used. How to interpolate with MATLAB is discussed in Sections 8.3 and 8.4.

8.1 POLYNOMIALS

Polynomials are functions that have the form:

The coefficients

 are real numbers, and n which is a nonnegative

262

Chapter 8: Polynomials, Curve Fitting, and Interpolation

integer, is the degree, or order, of the polynomial.

Examples of polynomials are:

f x

=

5x5

+

6x2

+

7x

+

3

polynomial of degree 5.

polynomial of degree 2.
polynomial of degree 1.

f x

6=

A constant (e.g.,

) is a polynomial of degree 0.
In MATLAB, polynomials are represented by a row vector in which the ele-
. The first element is the coefficient of
ments are the coefficients
the  x  with  the  highest  power.  The  vector  has  to  include  all  the  coefficients,
including the ones that are equal to 0. For example:

Polynomial

8x

5+

,  MATLAB form:

,  MATLAB form:

MATLAB representation

p = [8  5]

d = [2  –4  10]

h = [6  0  –150]

c = [5  0  0  6  7  0]

8.1.1 Value of a Polynomial

The value  of  a  polynomial  at  a  point  x  can  be  calculated  with  the  function
polyval that has the form:

polyval(p,x)

p is a vector with the coef-
ficients of the polynomial.

x is a number, or a variable that
has an assigned value, or a com-
putable expression.

x can also be a vector or a matrix. In such a case the polynomial is calculated
for each element (element-by-element), and the answer is a vector, or a matrix,
with the corresponding values of the polynomial.

Sample Problem 8-1: Calculating polynomials with MATLAB

For the polynomial
(a) Calculate
.
(b) Plot the polynomial for

f 9

Solution

.

:

The problem is solved in the Command Window.
(a) The coefficients of the polynomials are assigned to vector p. The function

8.1 Polynomials

263

polyval is then used to calculate the value at x = 9.

>> p = [1 -12.1 40.59 -17.015 -71.95 35.88];

>> polyval(p,9)

ans =
  7.2611e+003

(b) To  plot  the  polynomial,  a  vector  x  is  first  defined  with  elements  ranging
from –1.5 to 6.7. Then a vector y is created with the values of the polynomial for
every element of x. Finally, a plot of y vs. x is made.

>> x=-1.5:0.1:6.7;

>> y=polyval(p,x);

>> plot(x,y)

Calculating the value of the polyno-
mial for each element of the vector x.

The plot created by MATLAB is presented below (axis labels were added with
the Plot Editor).

y

150

100

50

0

-50

-100

-150

-200

-2

-1

0

1

2

3

4

5

6

7

x

8.1.2 Roots of a Polynomial

The roots of a polynomial are the values of the argument for which the value of
the  polynomial  is  equal  to  zero.  For  example,  the  roots  of  the  polynomial

  are  the  values  of  x  for  which

,  which  are

 and x = 3.

MATLAB has a function, called roots, that determines the root, or roots,

of a polynomial. The form of the function is:

r = roots(p)

r  is  a  column  vector  with
the roots of the polynomial.

p is a row vector with the coef-
ficients of the polynomial.

For example, the roots of the polynomial in Sample Problem 8-1 can be deter-
mined by:

264

Chapter 8: Polynomials, Curve Fitting, and Interpolation

>> p= 1 -12.1 40.59 -17.015 -71.95 35.88];

>> r=roots(p)

r =
    6.5000
    4.0000
    2.3000
   -1.2000
    0.5000

When  the  roots  are  known,  the  polynomial  can
actually be written as:

The roots command is very useful for finding the roots of a quadratic equa-

tion. For example, to find the roots of

, type:

>> roots([4 10 -8])

ans =
   -3.1375
    0.6375

When  the  roots  of  a  polynomial  are  known,  the  poly  command  can  be
used for determining the coefficients of the polynomial. The form of the poly
command is:

p = poly(r)

p is a row vector with the coef-
ficients of the polynomial.

r is a vector (row or column)
with the roots of the polynomial.

For example, the coefficients of the polynomial in Sample Problem 8-1 can be
obtained from the roots of the polynomial (see above) by:

>> r=[6.5 4 2.3 -1.2 0.5];

>> p=poly(r)

p =
    1.0000  -12.1000   40.5900  -17.0150  -71.9500   35.8800

8.1.3 Addition, Multiplication, and Division of Polynomials

Addition:

Two polynomials can be added (or subtracted) by adding (subtracting) the vec-
tors  of  the  coefficients.  If  the  polynomials  are  not  of  the  same  order  (which
means that the vectors of the coefficients are not of the same length), the shorter
vector has to be modified to be of the same length as the longer vector by add-
ing zeros (called padding) in front. For example, the polynomials

 and

 can be added

by:

8.1 Polynomials

265

>> p1=[3 15 0 -10 -3 15 -40];

>> p2=[3 0 -2 -6];

>> p=p1+[0 0 0 p2]

p =
     3    15     0    -7    -3    13   -46

Three 0s are added in front
of p2, since the order of p1
is 6 and the order of p2 is 3.

Multiplication:

Two polynomials can be multiplied using the MATLAB built-in function conv,
which has the form:

c = conv(a,b)

c is a vector of the coefficients
of the polynomial that is the
product of the multiplication.

a  and  b  are  the  vectors  of  the
coefficients  of  the  polynomials
that are being multiplied.

• The two polynomials do not have to be of the same order.

• Multiplication of three or more polynomials is done by using the conv function

repeatedly.

For example, multiplication of the polynomials

f1 x

 and

f2 x

 above gives:

>> pm=conv(p1,p2)

pm =
     9    45    -6   -78   -99    65   -54   -12   -10   240

which means that the answer is:

Division:

A polynomial can be divided by another polynomial with the MATLAB built-in
function deconv, which has the form:

[q,r] = deconv(u,v)

q  is  a  vector  with  the  coefficients
of the quotient polynomial.
r  is  a  vector  with  the  coefficients
of the remainder polynomial.

u is a vector with the coefficients of
the numerator polynomial.
v is a vector with the coefficients of
the denominator polynomial.

For example, dividing

 by

x

3+

 is done by:

>> u=[2 9 7 -6];

>> v=[1 3];

266

Chapter 8: Polynomials, Curve Fitting, and Interpolation

>> [a b]=deconv(u,v)

a =
     2     3    -2

b =
     0     0     0     0

The answer is:

.

Remainder is zero.

An  example  of  division  that  gives  a  remainder  is

divided by

:

>> w=[2 -13 0 75 2 0 -60];

>> z=[1 0 -5];

>> [g h]=deconv(w,z)

g =
    2  -13   10   10   52

The quotient is:

h =
    0   0   0   0   0   50   200

The remainder is:

.

.

The answer is:

.

8.1.4 Derivatives of Polynomials

The built-in function polyder can be used to calculate the derivative of a sin-
gle polynomial, a product of two polynomials, or a quotient of two polynomials,
as shown in the following three commands.

k = polyder(p)

k = polyder(a,b)

Derivative  of  a  single  polynomial.  p  is  a  vector  with
the coefficients of the polynomial. k is a vector with
the  coefficients  of  the  polynomial  that  is  the  deriva-
tive.

Derivative of a product of two polynomials. a and b
are  vectors  with  the  coefficients  of  the  polynomials
that are multiplied. k is a vector with the coefficients
of the polynomial that is the derivative of the product.

[n d]= polyder(u,v) Derivative of a quotient of two polynomials. u and v
are vectors with the coefficients of the numerator and
denominator polynomials. n and d are  vectors  with
the  coefficients  of  the  numerator  and  denominator
polynomials in the quotient that is the derivative.

The  only  difference  between  the  last  two  commands  is  the  number  of  output
arguments. With two output arguments MATLAB calculates the derivative of
the quotient of two polynomials. With one output argument, the derivative is of
the product.


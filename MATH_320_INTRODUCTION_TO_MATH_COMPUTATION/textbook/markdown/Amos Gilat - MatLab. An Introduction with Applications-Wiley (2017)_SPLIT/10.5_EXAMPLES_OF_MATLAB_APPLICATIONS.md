336

Chapter 10: Three-Dimensional Plots

• The view command can also set a default view:

view(2)

view(3)

sets the default to the top view, which is a projection onto the
x-y plane with az = 0°, and el = 90°.
sets the default to the standard 3-D view with az = –37.5° and
el = 30°.

• The viewing direction can also be set by selecting a point in space from which
the  plot
is  viewed.  In  this  case  the  view  command  has  the  form
view([x,y,z]),  where  x,  y,  and  z  are  the  coordinates  of  the  point.  The
direction is determined by the direction from the specified point to the origin of
the coordinate system and is independent of the distance. This means that the
view is the same with point [6, 6, 6] as with point [10, 10, 10]. Top view can be set
up with [0, 0, 1]. A side view of the x z plane from the negative y direction can be
set with [0, –1, 0], and so on.

10.5 EXAMPLES OF MATLAB APPLICATIONS

Sample Problem 10-1: 3-D projectile trajectory

A projectile is fired with an initial velocity of
250 m/s at an angle of
 = 65° relative to the
ground.  The  projectile  is  aimed  directly
north.  Because  of  a  strong  wind  blowing  to
the  west,  the  projectile  also  moves  in  this
direction  at  a  constant  speed  of  30  m/s.
Determine and plot the trajectory of the pro-
jectile  until it  hits  the ground. For  compari-
son, plot also (in the same figure) the trajectory that the projectile would have
had if there was no wind.

Solution

As shown in the figure, the coordinate system is set up such that the x and y axes
point in the east and north directions, respectively. Then the motion of the pro-
jectile can be analyzed by considering the vertical direction z and the two hori-
zontal components x and y. Since the projectile is fired directly north, the initial
 can be resolved into a horizontal y component and a vertical z com-
velocity
ponent:

v0

v0y

=

v0 cos

    and

v0z

=

v0 sin

In addition, due to the wind the projectile has a constant velocity in the negative
x direction,

m/s.

The initial position of the projectile (x0, y0, z0) is at point (3000, 0, 0). In the ver-
tical direction the velocity and position of the projectile are given by:

10.5 Examples of MATLAB Applications

337

  and

The  time  it  takes  the  projectile  to  reach  the  highest  point

vz

0=

  is

thmax

=

v0z
-------
g

. The total flying time is twice this time,

ttot

=

2thmax

. In the hori-

zontal direction the velocity is constant (both in the x and y directions), and the
position of the projectile is given by:
vxt+

  and

v0yt

x0

y0

=

+

=

x

y

The following MATLAB program written in a script file solves the problem by
following the equations above.

v0=250; g=9.81; theta=65;

x0=3000; vx=-30;

v0z=v0*sin(theta*pi/180);

v0y=v0*cos(theta*pi/180);

t=2*v0z/g;

tplot=linspace(0,t,100);

Creating a time vector with 100 elements.

z=v0z*tplot-0.5*g*tplot.^2;

y=v0y*tplot;

x=x0+vx*tplot;

xnowind(1:length(y))=x0;

Calculating the x, y, and z coordi-
nates of the projectile at each time.

plot3(x,y,z,'k-',xnowind,y,z,'k--')

Constant x coordinate when no wind.
Two 3-D line plots.

grid on

axis([0 6000 0 6000 0 2700])

xlabel('x (m)'); ylabel('y (m)'); zlabel('z (m)')

The figure generated by the program is shown below.

2500

2000

)

m

(

z

1500

1000

500

0
6000

4000

y (m)

2000

0

0

2000

1000

5000

4000

6000

3000

x (m)

338

Chapter 10: Three-Dimensional Plots

Sample Problem 10-2: Electric potential of two point charges

The electric potential V around a charged particle is given by

V

=

1
-------------
4
0

q
--
r

where

0

C
---------------
N m2

 is the permittivity constant, q is the magni-

tude of the charge in coulombs, and r is the distance from the particle in meters.
The electric field of two or more particles is calculated by using superposition.
For example, the electric potential at a point due to two particles is given by

V

=

1
-----------
4
0

q1
-----
r1

q2
-----+
r2

,
q1 q2

where
the point to the corresponding particle, respectively.

, and

r2

r1

,

 are the charges of the particles and the distance from

Two  particles  with  a  charge  of

C and

 C are posi-
tioned in the x y plane at points (0.25, 0, 0)
and  (–0.25,  0,  0),  respectively,  as  shown.
Calculate and plot the electric potential due
to  the  two  particles  at  points  in  the  x  y
plane  that  are  located  in  the  domain
 (the units
in the x y plane are meters). Make the plot
such that the x y plane is the plane of the points, and the z axis is the magnitude
of the electric potential.

 and

Solution

The problem is solved by following these steps:
(a) A  grid  is  created  in  the  x  y  plane  with  the  domain

  and

.

(b) The distance from each grid point to each of the charges is calculated.
(c) The electric potential at each point is calculated.
(d) The electric potential is plotted.
The following is a program in a script file that solves the problem.

eps0=8.85e-12; q1=2e-10; q2=3e-10;

k=1/(4*pi*eps0);

x=-0.2:0.01:0.2;

y=-0.2:0.01:0.2;

[X,Y]=meshgrid(x,y);

r1=sqrt((X+0.25).^2+Y.^2);

Creating a grid in the x y plane.
Calculating the distance r1 for each grid point.

10.5 Examples of MATLAB Applications

339

r2=sqrt((X-0.25).^2+Y.^2);

V=k*(q1./r1+q2./r2);

mesh(X,Y,V)

Calculating the distance r2 for each grid point.
Calculating the electric potential V at each grid point.

xlabel('x (m)'); ylabel('y (m)'); zlabel('V (V)')

The plot generated when the program runs is:

60

50

40

30

20

)

V

(

V

10
0.2

0.1

0

y (m)

-0.1

-0.1

0

x (m)

-0.2

-0.2

0.2

0.1

Sample Problem 10-3: Heat conduction in a square plate

Three sides of a rectangular plate (a = 5 m, b = 4
m) are kept at a temperature of 0°C and one side
is  kept  at  a  temperature
°C,  as  shown  in
the  figure.  Determine  and  plot  the  temperature
distribution T(x, y) in the plate.

80=

T1

Solution

y

b

T=0

T=80oC

T=0

x

T=0

a

The temperature distribution, T(x, y) in the plate can be determined by solving
the two-dimensional heat equation. For the given boundary conditions T(x, y)
can  be  expressed  analytically  by  a  Fourier  series  (Erwin  Kreyszig,  Advanced
Engineering Mathematics, John Wiley and Sons, 1993):

n

1=

A program in a script file that solves the problem is listed below. The program
follows these steps:
(a) Create an X, Y grid in the domain

. The length of the
plate, a, is divided into 20 segments, and the width of the plate, b, is divided
into 16 segments.

 and

(b) Calculate the  temperature at each  point of the  mesh.  The  calculations  are

340

Chapter 10: Three-Dimensional Plots

done point by point using a double loop. At each point the temperature is
determined by adding k terms of the Fourier series.

(c) Make a surface plot of T.

a=5; b=4; na=20; nb=16; k=5; T0=80;

clear T

x=linspace(0,a,na);

y=linspace(0,b,nb);

[X,Y]=meshgrid(x,y);

for i=1:nb

    for j=1:na

        T(i,j)=0;

        for n=1:k

            ns=2*n-1;

Creating a grid in the x y plane.
First loop, i, is the index of the grid’s row.

Second loop, j, is the index of the grid’s column.

Third loop, n, is the nth term of the Fourier
series, k is the number of terms.

      T(i,j)=T(i,j)+sin(ns*pi*X(i,j)/a).*sinh(ns*pi*Y(i,j)/
a)/(sinh(ns*pi*b/a)*ns);

        end

        T(i,j) = T(i,j)*4*T0/pi;

    end

end

mesh(X,Y,T)

xlabel('x (m)'); ylabel('y (m)'); zlabel('T ( ^oC)')

The  program  was  executed  twice,  first  using  five  terms  (k  =  5)  in  the  Fourier
series to calculate the temperature at each point, and then with k = 50. The mesh
plots created in each execution are shown in the figures below. The temperature
should be uniformly 80°C at y = 4 m. Note the effect of the number of terms (k)
on the accuracy at y = 4 m.

k = 5

)

C

o

(
T

100

80

60

40

20

0
4

k = 50

)

C

o

(
T

100

80

60

40

20

0
4

3

2

y (m)

1

0

0

1

5

4

2

3
x (m)

3

2
y (m)

1

0

0

1

5

4

2

3
x (m)


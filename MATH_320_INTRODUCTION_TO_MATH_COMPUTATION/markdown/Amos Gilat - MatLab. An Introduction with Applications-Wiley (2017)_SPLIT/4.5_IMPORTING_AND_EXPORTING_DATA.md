114

Chapter 4: Using Script Files and Managing Data

4.5 IMPORTING AND EXPORTING DATA

MATLAB is often used for analyzing data that was recorded in experiments or
generated by other computer programs. This can be done by first importing the
data into MATLAB. Similarly, data that is produced by MATLAB sometimes
needs to be transferred to other computer applications. There are various types
of  data  (numerical,  text,  audio,  graphics,  and  images).  This  section  describes
only how to import and export numerical data, which is probably the most com-
mon type of data that needs to be transferred by new users of MATLAB. For
other types of data transfer, look in the Help Window under File I/O.

Importing  data  can  be  done  either  by  using  commands  or  by  using  the
Import  Wizard.  Commands  are  useful  when  the  format  of  the  data  being
imported  is  known.  MATLAB  has  several  commands  that  can  be  used  for
importing various types of data. Importing commands can also be included in a
script file such that the data is imported when the script is executed. The Import
Wizard is useful when the format of the data (or the command that is applicable
for importing the data) is not known. The Import Wizard determines the format
of the data and automatically imports it.

4.5.1 Commands for Importing and Exporting Data

This  section  describes—in  detail—how  to  transfer  data  into  and  out  of  Excel
spreadsheets. Microsoft Excel is commonly used for storing data, and Excel is
compatible with many data recording devices and computer applications. Many
people  are  also  capable  of  importing  and  exporting  various  data  formats  into
and from Excel. MATLAB also has commands for transferring data directly to
and from formats such as csv and ASCII, as well as to the spreadsheet program
Lotus 123. Details of these and many other commands can be found in the Help
Window under File I/O

Importing and exporting data into and from Excel:

Importing  data  from  Excel  is  done  with  the  xlsread  command.  When  the
command is executed, the data from the spreadsheet is assigned as an array to a
variable. The simplest form of the xlsread command is:

variable_name = xlsread(‘filename’)

• ‘filename’ (typed as a string) is the name of the Excel file. The directory of
the Excel file must be either the current directory or listed in the search path.

•

If the Excel file has more than one sheet, the data will be imported from the first
sheet.

4.5 Importing and Exporting Data

115

When an Excel file has several sheets, the xlsread command can be used to
import data from a specified sheet. The form of the command is then:

variable_name = xlsread(‘filename’,‘sheet_name’)

• The name of the sheet is typed as a string.

Another option is to import only a portion of the data that is in the spreadsheet.
This is done by typing an additional argument in the command:

variable_name = xlsread(‘filename’,‘sheet_name’,‘range’)

• The  ‘range’  (typed  as  a  string)  is  a  rectangular  region  of  the  spreadsheet
defined by the addresses (in Excel notation) of the cells at opposite corners of
the region. For example, ‘C2:E5’ is a
 region of rows 2, 3, 4, and 5 and
columns C, D, and E.

Exporting  data  from  MATLAB  to  an  Excel  spreadsheet  is  done  by  using  the
xlswrite command. The simplest form of the command is:

xlswrite(‘filename’,variable_name)

• ‘filename’ (typed as a string) is the name of the Excel file to which the data
is exported. The file must be in the current directory. If the file does not exist, a
new Excel file with the specified name will be created.

• variable_name is the name of the variable in MATLAB with the assigned

data that is being exported.

• The  arguments  ‘sheet_name’  and  ‘range’  can  be  added  to  the  xls-
write command to export to a specified sheet and to a specified range of cells,
respectively.

As  an  example,  the  data  from  the  Excel  spreadsheet  shown  in  Figure  4-7  is
imported into MATLAB by using the xlsread command.

Figure 4-7: Excel spreadsheet with data.

116

Chapter 4: Using Script Files and Managing Data

The  spreadsheet  is  saved  in  a  file  named  TestData1  in  a  disk  in  drive  A.
After  the  Current  Directory  is  changed  to  drive  A,  the  data  is  imported  into
MATLAB by assigning it to the variable DATA:

>> DATA = xlsread('TestData1')

DATA =

 11.0000   2.0000  34.0000  14.0000  -6.0000        0   8.0000
 15.0000   6.0000 -20.0000   8.0000   0.5600  33.0000   5.0000
  0.9000  10.0000   3.0000  12.0000 -25.0000  -0.1000   4.0000
 55.0000   9.0000   1.0000  -0.5550  17.0000   6.0000 -30.0000

4.5.2 Using the Import Wizard

Using the Import Wizard is probably the easiest way to import data into MAT-
LAB since the user does not have to know, or to specify, the format of the data.
The Import Wizard is activated by selecting Import Data in the File menu of the
Command Window. (It can also be started by typing the command uiimport.)
The  Import Wizard starts by displaying  a file selection box that shows all the
data files recognized by the Wizard. The user then selects the file that contains
the data to be imported, and clicks Open. The Import Wizard opens the file and
displays a portion of the data in a preview box so that the user can verify that
the data is the correct choice. The Import Wizard tries to process the data, and if
the wizard is successful, it displays the variables it has created with a portion of
the data. The user clicks next and the wizard shows the Column Separator that
was used. If the variable has the correct data, the user can proceed with the wiz-
ard (click next); otherwise the user can choose a different Column Separator. In
the next window the wizard shows the name and size of the variable to be cre-
ated in MATLAB.  (When  the data is  all  numerical, the  variable  in  MATLAB
has the same name as the file from which the data was imported.) When the wiz-
ard ends (click finish), the data is imported to MATLAB.

As an example, the Import Wizard is used to import numerical ASCII data
saved in a .txt file. The data saved with the file name TestData2 is shown in Fig-
ure 4-8.

Figure 4-8: Numerical ASCII data.

4.5 Importing and Exporting Data

117

The display of the Import Wizard during the import process for the TestData2
file is shown in Figures 4-9 and 4-10. Figure 4-10 shows that the name of the
variable in MATLAB is TestData2 and its size is

.

Figure 4-9: Import Wizard, first display.

Figure 4-10: Import Wizard, second display.

In the Command Window of MATLAB, the imported data can be displayed by
typing the name of the variable.

>> TestData2

TestData2 =
  5.1200   33.0000   22.0000   13.0000    4.0000
  4.0000   92.0000         0    1.0000    7.5000
 12.0000    5.0000    6.5300   15.0000    3.0000


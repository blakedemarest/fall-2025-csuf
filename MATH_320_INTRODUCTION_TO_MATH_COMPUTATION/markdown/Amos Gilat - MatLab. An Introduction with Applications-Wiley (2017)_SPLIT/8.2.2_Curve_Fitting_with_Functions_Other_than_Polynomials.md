8.2 Curve Fitting

271

with the function polyval to create a vector yp with the value of the polyno-
mial for each element of xp.

When  the  script  file  is  executed,  the  following  vector  p  is  displayed  in  the

Command Window.

p =
    0.0220   -0.4005    2.6138   -1.4158

This means that the polynomial of the third degree in Figure 8-2 has the form

.

8.2.2 Curve Fitting with Functions Other than Polynomials

Many situations in science and engineering require fitting functions that are not
polynomials  to  given  data.  Theoretically,  any  function  can  be  used  to  model
data within some range. For a particular data set, however, some functions pro-
vide a better fit than others. In addition, determining the best-fitting coefficients
can  be  more  difficult  for  some  functions  than  for  others.  This  section  covers
curve  fitting  with  power,  exponential,  logarithmic,  and  reciprocal  functions,
which are commonly used. The forms of these functions are:

y

y

=

=

y

=

bxm

bemx
m xln

  or
y
=
  or
b+

b10mx
y
=

m

log

x

b+

(power function)
(exponential function)
 (logarithmic function)

(reciprocal function)

All of these functions can easily be fitted to given data with the polyfit func-
tion. This is done by rewriting the functions in a form that can be fitted with a
linear polynomial (n = 1), which is

The  logarithmic  function  is  already  in  this  form,  and  the  power,  exponential,
and reciprocal equations can be rewritten as:

y

=

mx

b+

ln

ln

y

y

=

=

m xln
mx

ln+

bln+
b

  or

log

y

=

mx

log+

b

(power function)
(exponential function)

(reciprocal function)

These equations describe a linear relationship between
 for the
ln
 and x for the exponential function, between y
power function, between
ln
 for the logarithmic function, and between 1/y and x for the
 or
and
reciprocal  function.  This  means  that  the  polyfit(x,y,1)  function  can  be
used to determine the best-fit constants m and b for best fit if, instead of x and y,

 and

xln

xln

log

x

y

y

272

Chapter 8: Polynomials, Curve Fitting, and Interpolation

the following arguments are used.

Function

polyfit function form

power

y

=

bxm

p=polyfit(log(x),log(y),1)

exponential
y

y

=

bemx
=
b10mx

  or

p=polyfit(x,log(y),1)  or
p=polyfit(x,log10(y),1)

logarithmic
y

y
=

=
m

m xln
x
log

b+
b+

   or

p=polyfit(log(x),y,1) or
p=polyfit(log10(x),y,1)

reciprocal

p=polyfit(x,1./y,1)

b
e p 2

The  result  of  the  polyfit  function  is  assigned  to  p,  which  is  a  two-element
vector.  The  first  element,  p(1),  is  the  constant  m,  and  the  second  element,
 for the
p(2), is b for the logarithmic and reciprocal functions,

 or

log

ln

b

exponential  function,  and

ln

b

  for  the  power  function  (

b

=

  or

10 p 2

b
=
tion).

  for  the  exponential  function,  and

b

=

e p 2

  for  the  power  func-

For given data it is possible to estimate, to some extent, which of the func-
tions has the potential for providing a good fit. This is done by plotting the data
using different combinations of linear and logarithmic axes. If the data points in
one of the plots appear to fit a straight line, the corresponding function can pro-
vide a good fit according to the list below.

x axis

linear

y axis

linear

Function

linear

y

=

mx

b+

logarithmic

logarithmic

power

y

=

bxm

linear

logarithmic

exponential

y

=

bemx

  or

y

=

b10mx

logarithmic

linear

logarithmic

y

=

m xln

b+

 or

y

=

m

log

x

b+

linear

linear
(plot 1/y)

reciprocal

Other considerations in choosing a function:

• Exponential functions cannot pass through the origin.

• Exponential functions can fit only data with all positive y’s or all negative y’s.

• Logarithmic functions cannot model x = 0 or negative values of x.

• For the power function y = 0 when x = 0.

• The reciprocal equation cannot model y = 0.

8.2 Curve Fitting

273

The following example illustrates the process of fitting a function to a set of data
points.

Sample Problem 8-2: Fitting an equation to data points

The  following  data  points  are  given.  Determine  a  function
  (t  is  the
independent variable, w is the dependent variable) with a form discussed in this
section that best fits the data.

f t=

w

t

w

0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

6.00

4.83

3.70

3.15

2.41

1.83

1.49

1.21

0.96

0.73

0.64

Solution

4

6

5

The data is first plotted with linear scales
on  both  axes.  The  figure  indicates  that  a
linear  function  will  not  give  the  best  fit
since the points do not appear to line up
along a straight line. From the other pos-
sible functions, the logarithmic function is
excluded  since  for  the  first  point
,
0=
and the  power  function is  excluded since
at
.  To  check  if  the  other
two functions (exponential and reciprocal) might give a better fit, two additional
plots, shown below, are made. The plot on the left has a log scale on the vertical
axis and linear  horizontal axis.  In the plot on the  right, both axes have linear
scales, and the quantity 1/w is plotted on the vertical axis.

0=

,

t

t

w

4

3

0

2

0

1

2

3

5

1

t

101

w

100

0

1

2

3

4

5

t

2

1.5

w
1

/

1

0.5

0

0

1

2

t

3

4

5

In  the  left  figure,  the  data  points  appear  to  line  up  along  a  straight  line.  This
indicates that an exponential function of the form
 can give a good fit
to the data. A program in a script file that determines the constants b and  m,
and that plots the data points and the function is given below.

bemx

=

y

t=0:0.5:5;

Create vectors t and w with the coordinates of the data points.

w=[6 4.83 3.7 3.15 2.41 1.83 1.49 1.21 0.96 0.73 0.64];

p=polyfit(t,log(w),1);

Use the polyfit function with t and log(w).

274

Chapter 8: Polynomials, Curve Fitting, and Interpolation

m=p(1)

b=exp(p(2))

tm=0:0.1:5;

wm=b*exp(m*tm);

Determine the coefficient b.
Create a vector tm to be used for plotting the polynomial.
Calculate the function value at each element of tm.

plot(t,w,'o',tm,wm)

Plot the data points and the function.

When the program is executed, the values of the constants m and b are displayed
in the Command Window.

m =
   -0.4580

b =
    5.9889

The plot generated by the program, which shows the data points and the func-
tion (with axis labels added with the Plot Editor) is

6

5

4

w

3

2

1

0

0

1

2

3

4

5

t

It should be pointed out here that in addition to the power, exponential, log-
arithmic, and reciprocal functions that are discussed in this section, many other
functions can be written in a form suitable for curve fitting with the polyfit

function. One example where a function of the form
 is fitted
to  data  points  using  the  polyfit  function  with  a  third-order  polynomial  is
described in Sample Problem 8-7.

=

y

e

a2x2

+

a1x

+

a0

8.3 INTERPOLATION

Interpolation  is  the  estimation  of  values  between  data  points.  MATLAB  has
interpolation  functions  that  are  based  on  polynomials,  which  are  described  in
this section, and on Fourier transformation, which is outside the scope of this
book. In one-dimensional interpolation, each point has one independent vari-
able (x) and one dependent variable (y). In two-dimensional interpolation, each
point has two independent variables (x and y) and one dependent variable (z).


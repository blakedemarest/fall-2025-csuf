8.2 Curve Fitting

267

For  example,  if

,  and

,  the  derivatives  of

,

, and

 can be determined by:

Creating the vectors of coefficients of f1 and f2.

>> f1= 3 -2 4];
>> f2=[1 0 5];

>> k=polyder(f1)

k =
     6    -2

>> d=polyder(f1,f2)

The derivative of f1 is:

.

.

d =
    12    -6    38   -10

The derivative of f1*f2 is:

>> [n d]=polyder(f1,f2)

n =
     2    22   -10

The derivative of

 is:

.

d =
     1     0    10     0    25

8.2 CURVE FITTING

Curve fitting, also called regression analysis, is a process of fitting a function to
a set of data points. The function can then be used as a mathematical model of
the  data.  Since  there  are  many  types  of  functions  (linear,  polynomial,  power,
exponential, etc.), curve fitting can be a complicated process. Many times one
has some idea of the type of function that might fit the given data and will need
only  to  determine  the  coefficients  of  the  function.  In  other  situations,  where
nothing is known about the data, it is possible to make different types of plots
that  provide  information  about  possible  forms  of  functions  that  might  fit  the
data well. This section describes some of the basic techniques for curve fitting
and the tools that MATLAB has for this purpose.

8.2.1 Curve Fitting with Polynomials; The polyfit Function

Polynomials can be used to fit data points in two ways. In one the polynomial
passes through all the data points, and in the other the polynomial does not nec-
essarily pass through any of the points but overall gives a good approximation
of the data. The two options are described below.

Polynomials that pass through all the points:
When n points (xi, yi) are given, it is possible to write a polynomial of degree
 that passes through all the points. For example, if two points are given it
is  possible  to  write  a  linear  equation  in  the  form  of
  that  passes
through  the  points.  With  three  points,  the  equation  has  the  form  of

b+

mx

=

y

268

Chapter 8: Polynomials, Curve Fitting, and Interpolation

.  With

n  points

the  polynomial  has

the

form

.  The  coefficients  of  the  polynomial  are  deter-
mined by substituting each point in the polynomial and then solving the n equa-
tions for the coefficients. As will be shown later in this section, polynomials of
high degree might give a large error if they are used to estimate values between
data points.

Polynomials that do not necessarily pass through any of the points:

When n points are given, it is possible to write a polynomial of degree less than
 that does not necessarily pass through any of the points but that overall
approximates the data. The most common method of finding the best fit to data
points  is  the  method  of  least  squares.  In  this  method,  the  coefficients  of  the
polynomial are determined by minimizing the sum of the squares of the residu-
als at all the data points. The residual at each point is defined as the difference
between  the  value  of  the  polynomial  and  the  value  of  the  data.  For  example,
consider the case of finding the equation of a straight line that best fits four data
,  and
points  as  shown  in  Figure  8-1. The  points  are

,

,

x1 y1,

x2 y2,

x3 y3,

y

f(x4)

f(x3)

f(x2)
f(x1)

(x2, y2)

R2

R1
(x1, y1)

(x4, y4)
R4

f(x) = a1x + a0

R3
(x3, y3)

x

Figure 8-1: Least squares fitting of first-degree polynomial to four points.

,  and  the  polynomial  of  the  first  degree  can  be  written  as
, at each point is the difference between the
a1x
. An equation for the sum of
,

x4 y4,
f x
=
value of the function at
xi
the squares of the residuals

. The residual,
 and
Ri

 of all the points is given by:

Ri
yi

a0+

or, after substituting the equation of the polynomial at each point, by:

At this stage R is a function of
by taking the partial derivative of R with respect to
and equating them to zero:

 and

a0

a1

. The minimum of R can be determined
 (two equations)

 and

a1

a0

  and

8.2 Curve Fitting

269

. The
This results in a system of two equations with two unknowns,
solution of these equations gives the values of the coefficients of the polynomial
that  best  fits  the  data.  The  same  procedure  can  be  followed  with  more  points
and higher-order polynomials. More details on the least squares method can be
found in books on numerical analysis.

 and

a0

a1

Curve  fitting  with  polynomials  is  done  in  MATLAB  with  the  polyfit
function, which uses the least squares method. The basic form of the polyfit
function is:

p = polyfit(x,y,n)

p is the vector of the coeffi-
cients of the polynomial
that fits the data.

x is a vector with the horizontal coordinates
of the data points (independent variable).
y is a vector with the vertical coordinates of
the data points (dependent variable).
n is the degree of the polynomial.

For the same set of m points, the polyfit function can be used to fit poly-
. If n = 1 the polynomial is a straight line, if n
nomials of any order up to
= 2 the polynomial is a parabola, and so on. The polynomial passes through all
the points if
 (the order of the polynomial is one less than the number
of points). It should be pointed out here that a polynomial that passes through
all the points, or polynomials with higher order, do not necessarily give a better
fit  overall.  High-order  polynomials  can  deviate  significantly  between  the  data
points.

Figure  8-2  shows  how  polynomials  of  different  degrees  fit  the  same  set  of
data points. A set of seven points is given by (0.9, 0.9), (1.5, 1.5), (3, 2.5), (4, 5.1),

y

7

6

5

4

3

2

1

0

n=1

0

2

4

x

6

8

10

y

7

6

5

4

3

2

1

0

n=2

0

2

4

6

8

10

Figure 8-2: Fitting data with polynomials of different order.

270

Chapter 8: Polynomials, Curve Fitting, and Interpolation

y

7

6

5

4

3

2

1

0

n=3

0

2

4

6

x

8

10

y

7

6

5

4

3

2

1

0

n = 4
n=4

0

2

4

x

6

8

10

y

7

6

5

4

3

2

1

0

n=5

0

2

4

x

6

8

10

y

10

8

6

4

2

0

0

n=6

2

4

x

6

8

10

Figure 8-2: Fitting data with polynomials of different order. (Continued)

(6, 4.5), (8, 4.9), and (9.5, 6.3). The points are fitted using the polyfit func-
tion with polynomials of degrees 1 through 6. Each plot in Figure 8-2 shows the
same data points, marked with circles, and a curve-fitted line that corresponds
to a polynomial of the specified degree. It can be seen that the polynomial with n
= 1 is a straight line, and that with n = 2 is a slightly curved line. As the degree of
the polynomial increases, the line develops more bends such that it passes closer
to more points. When n = 6, which is one less than the number of points, the line
passes  through  all  the  points.  However,  between  some  of  the  points,  the  line
deviates significantly from the trend of the data.

The script file used to generate one of the plots in Figure 8-2 (the polyno-
mial with n = 3) is shown below. Note that in order to plot the polynomial (the
line),  a  new  vector  xp  with  small  spacing  is  created.  This  vector  is  then  used

x=[0.9 1.5 3 4 6 8 9.5];

y=[0.9 1.5 2.5 5.1 4.5 4.9 6.3];

Create vectors x and y with the
coordinates of the data points.

p=polyfit(x,y,3)

Create a vector p using the polyfit function.

xp=0.9:0.1:9.5;

yp=polyval(p,xp);

Create a vector xp to be used for plotting the polynomial.
Create a vector yp with values of the polynomial at each xp.

plot(x,y,'o',xp,yp)

A plot of the seven points and the polynomial.

xlabel('x'); ylabel('y')

